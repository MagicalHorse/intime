<div class="module module-white">

  <div class="module-form form-padding">
    <%= form_tag ims_card_orders_path, id: "new_card_order", class: "form-block-label", remote: true, method: 'post' do %>
    <%= hidden_field_tag :store_id, params[:store_id] %>
    <div class="form-label">
      <span class="txt1">请选择购卡金额</span>
      <% @cards.each do |card| %>
      <label class="radio" class="radio" for="money_<%= card["unit_price"] %>">
        <input id="money_<%= card["unit_price"] %>" name="money" type="radio" value="<%= "#{card["id"]},#{card["price"]}" %>" class="valid"><%= card["unit_price"] %>元（售价<%= card["price"] %>元）
      </label> 
      <% end %>
      <label class="checkbox" for="is_accept">
        <input id="is_accept" name="is_accept" type="checkbox" value="1" class="valid">我已阅读并同意<%= link_to "《银泰礼品卡服务协议》", agreement_ims_cards_path %>
      </label>
    </div> 
    <div class="module-btn text-center">
      <%= submit_tag "确认购买", class: "btn btn-large btn-danger btn-block", id: "submit" %>
    </div>

    <% end %>
    <div class="module module-notice">
      <h4><i class="fa fa-exclamation-circle"></i> 温馨提示</h4>
      <ol>
        <li>礼品卡已经购买，暂不支持退货、退款。</li>
        <li>购买成功后，您可以选择转送朋友或自己充值。</li>
        <li>充值成功后，礼品卡支持线下任何一家银泰实体门店支付。</li>
      </ol>
    </div>

  </div>

</div> 
<div id="ex2" style="display:none;"></div>

<%= content_for :javascripts do %>
<script>
  $(function(){
    $("#submit").click(function(){
      if( $("input[name='money']:checked").val() == undefined ){
        $("#ex2").html("<div class='text-center'><div class='txt4 txt-red'>温馨提示</div><div class='txt4'>请选择礼品卡</div><a class='btn btn-danger btn-small btn-block btn-modal' rel='modal:close'>OK</a></div>");
        $("#ex2").modal({
          clickClose: true,
          showClose: false
        });
        return false;
      }else if( $("#is_accept").prop("checked") == false ){
        $("#ex2").html("<div class='text-center'><div class='txt4 txt-red'>温馨提示</div><div class='txt4'>您必须同意礼品卡服务协议</div><a class='btn btn-danger btn-small btn-block btn-modal' rel='modal:close'>OK</a></div>");
        $("#ex2").modal({
          clickClose: true,
          showClose: false
        });
        return false;
      }
    })
  });
</script>
<% end %>