礼品卡

<% @gift_cards.each do |card| %>
<%= image_tag "/image/1.jpg" %><br/>

<%= card["desc"] %>

<%= link_to card["is_online"] ? "下架" : "上架", "javascript:void(0);", class: "card_or_combo", item_id: card["id"], item_type: 1 %>
<% end %>



商品搭配

<% @combos.each do |combo| %>
  <%= image_tag "/images/1.jpg" %>
  <%= link_to combo["desc"], new_ims_store_combo_path(combo["id"]) %>
  <!-- 这里要改为编辑 -->
  组合价: ￥<%= combo["price"] %>
  <%= link_to combo["is_online"] ? "下架" : "上架", "javascript:void(0);", class: "card_or_combo", item_id: combo["id"], item_type: 2 %>
<% end %>

<%= link_to '添加搭配商品', new_ims_store_combo_path %>

<% content_for :javascripts do %>
<script>
  $(function(){

    $(document).on("click", ".card_or_combo", function(){
      this_ele = $(this)
      store_id = "store_id"
      item_id = this_ele.attr("item_id")
      item_type = this_ele.attr("item_type")
      text = this_ele.text()
      is_online = text == "上架" ? true : false
      $.post("/ims/store/sells/id/update_is_online", {_method: "put", store_id: store_id, item_id: item_id, item_type: item_type, is_online: is_online}, function(data){
        if(data["status"]){
          this_ele.text(is_online ? "下架" : "下架")
        }else{
          alert(text+"失败")
        }
      })
    })

  })
</script>
<% end %>


