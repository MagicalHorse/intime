<%= content_for :stylesheets do -%>
  <link href="/css/perfect-scrollbar-0.4.3.min.css" rel="stylesheet">
<% end -%>
<%= content_for :head_nav do -%>
  <ul class="nav">

    <li class="dropdown" id="menu1">
    <a class="dropdown-toggle" id="drop1" role="button" data-toggle="dropdown" href="javascript:0">分类<b class="caret"></b></a>
    <ul class="dropdown-menu span9 ps-container" role="menu" aria-labelledby="drop1" style="">
      <dl class="hot">
        <dt>热门分类</dt>
        <% @hotwords[:words] && @hotwords[:words].each do |word| %>
          <dd role="presentation">
          <a role="menuitem" tabindex="-1" href="#" onClick="gallery.clears(),gallery.loadData('#{word}')">
            <%= word %>
          </a>
          </dd>
        <% end %>
      </dl>
      <dl>
        <dd role="presentation">
        <a role="menuitem" class="active" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('category','');">全部</a>
        </dd>
        <% @tags[:tags] && @tags[:tags].each do |tag|%>
          <dd role="presentation">
          <a role="menuitem" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('category',<%= tag[:id]%>);">
            <%= tag[:name] %>
          </a>
          </dd>
        <% end %>
      </dl>
      <div class="ps-scrollbar-x" style="left: 0px; bottom: 3px; width: 0px;"></div>
      <div class="ps-scrollbar-y" style="top: 0px; right: 3px; height: 0px;"></div></ul>
    </li>

    <li class="dropdown" id="menu2">
    <a class="dropdown-toggle" id="drop2" role="button" data-toggle="dropdown" href="javascript:0">品牌<b class="caret"></b></a>
    <ul class="dropdown-menu span9 ps-container" role="menu" aria-labelledby="drop1" style="">
      <dl class="hot">
        <dt>热门品牌</dt>
        <% @hotwords[:brandwords] && @hotwords[:brandwords].each do |brand| %>
          <dd role="presentation">
          <a role="menuitem" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('brand',<%= brand["id"]%>);">
            <%= brand["name"] %>
          </a>
          </dd>
        <% end %>
      </dl>
      <dl class="brands">
        <dt id="myTab">
        <span class="all active"><a href="#brandALL" class="active" title="查看全部品牌的产品">全部</a></span>
        <% ('A'..'Z').to_a.each do |character| %>
          <span><a href="#brand<%= character%>" title="查找以中英文首字母为 <%= character%> 的品牌"><%= character%></a></span>
        <% end %>
        </dt>
        <div id="myTabContent" class="tab-content" style="overflow:visible;">
          <div class="tab-pane" id="brandALL">
            <% @all_brands && @all_brands.each do |brand| %>
              <dd role="presentation">
              <a role="menuitem" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('brand',<%= brand[:id]%>);">
                <p style="display:block"><%= brand[:name]%></p>
              </a>
              </dd>
            <% end %>
          </div>

          <% ('A'..'Z').to_a.each do |character| %>
            <div class="tab-pane" id="brand<%= character%>">
              <% @brands[character] && @brands[character].each do |brand| %>
                <dd role="presentation">
                <a role="menuitem" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('brand',<%= brand[:id]%>);">
                  <p style="display:block" ><%= brand[:name]%></p>
                </a>
                </dd>
              <% end %>
            </div>
          <% end %>

        </div>
        <div class="clearfix"></div>
      </dl>
      <div class="ps-scrollbar-x" style="left: 0px; bottom: 3px; width: 0px;"></div>
      <div class="ps-scrollbar-y" style="top: 0px; right: 3px; height: 0px;"></div>
    </ul>
    </li>
				
    <li class="dropdown" id="menu3">
    <a class="dropdown-toggle" id="drop3" role="button" data-toggle="dropdown" href="javascript:0">商店<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu" aria-labelledby="drop3">
      <li role="presentation" class="active"><a role="menuitem"  class="active" tabindex="-1" href="#">全部门店</a></li>
      <% @stores[:stores] && @stores[:stores].each do |store| %>
        <li role="presentation">
        <a role="menuitem" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('store',<%= store[:id]%>);">
          <%= store[:name] %>
        </a>
        </li>
      <% end %>
    </ul>
    </li>

    <li class="dropdown" id="menu4">
    <a class="dropdown-toggle" id="drop4" role="button" data-toggle="dropdown" href="javascript:0">排序<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu" aria-labelledby="drop4">
      <li role="presentation" class="active">
      <a role="menuitem" class="active" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('sortby',1);">最新发布</a>
      </li>
      <li role="presentation">
      <a role="menuitem" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('sortby',2);">价格最高</a>
      </li>
      <li role="presentation">
      <a role="menuitem" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('sortby',3);">价格最低</a>
      </li>
      <li role="presentation">
      <a role="menuitem" tabindex="-1" href="#" onclick="gallery.clears(),gallery.loadData('sortby',4);">人气最高</a>
      </li>
    </ul>
    </li>

    <div class="input-append pull-right search">
      <input type="text" id="search" placeholder="请输入搜索内容">
      <button class="btn" type="button" onClick="gallery.clears(),gallery.loadData($('#search').val());">
        <i class="icon-search icon-large"></i>
      </button>
    </div>
    <!--/.search-collapse -->
  </ul>

<% end -%>

<div class="span9 main">
  <section class="portfolio">
  <ul id="tiles" class="thumbnails tmode">

  </ul>
  <div id="no_data"><p style="text-align:center;font-size: 16px;line-height:30px;">分类目录下暂时没有更多的商品!</p></div>
  <div id="loader">
    <div id="loaderCircle"></div>
  </div>
  </section>
  
</div>

<%= content_for :javascripts do -%>
  <script src="/js/masonry.pkgd.min.js"></script>
  <script src="/js/mousewheel.min.js"></script>
  <script src="/js/gallery.js"></script>
  <script>
    //分类&品牌滚动条
    $('.navbar .nav #menu1 .dropdown-menu,.navbar .nav #menu2 .dropdown-menu').perfectScrollbar({
      wheelSpeed: 30,
      wheelPropagation: false
    });	

    //停止监听下拉菜单 & 启动标签页 & 选中效果
    $('#myTab a').click(function (e) {
      e.preventDefault();
      e.stopPropagation();
      $(this).tab('show');
      $("#myTab a").removeClass("active");
      $(this).addClass("active");
    })

    $("#menu2 .hot a").click(function(){
      $("#menu2 .hot a").removeClass("active");
      $(this).addClass("active");
    });

    $("#menu1 .dropdown-menu a").click(function(){
      $("#menu1 .dropdown-menu a").removeClass("active");
      $(this).addClass("active");
    });

    $("#menu3 .dropdown-menu li a").click(function(){
      $("#menu3 .dropdown-menu li a").removeClass("active");
      $(this).addClass("active");
    });

    $("#menu4 .dropdown-menu li a").click(function(){
      $("#menu4 .dropdown-menu li a").removeClass("active");
      $(this).addClass("active");
    });
    $(document).ready(function() {
      $('#no_data').hide();
      gallery = intime.gallery;
      $(document).bind('scroll', gallery.onScroll);
      gallery.loadData('s','c');
    });
  </script>
<% end -%>
